import{p as y}from"./ajax-9f8188be.js";import{_ as P,d as N,g as A,c as z,i as O,o as g,a as S,n as V,b as W,e as i,f as F,u as D,m as E,M as h,h as C,t as u,l as c,j as w,w as f,p as I,q as Z,F as G,v as H,x,k as J}from"./main-37bc4461.js";const K=N({name:"IconLocation",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},emits:{click:e=>!0},setup(e,{emit:s}){const o=A("icon"),n=z(()=>[o,`${o}-location`,{[`${o}-spin`]:e.spin}]),p=z(()=>{const r={};return e.size&&(r.fontSize=O(e.size)?`${e.size}px`:e.size),e.rotate&&(r.transform=`rotate(${e.rotate}deg)`),r});return{cls:n,innerStyle:p,onClick:r=>{s("click",r)}}}}),Q=["stroke-width","stroke-linecap","stroke-linejoin"],U=i("circle",{cx:"24",cy:"19",r:"5"},null,-1),X=i("path",{d:"M39 20.405C39 28.914 24 43 24 43S9 28.914 9 20.405C9 11.897 15.716 5 24 5c8.284 0 15 6.897 15 15.405Z"},null,-1),Y=[U,X];function ee(e,s,o,n,p,a){return g(),S("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:V(e.cls),style:W(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin,onClick:s[0]||(s[0]=(...r)=>e.onClick&&e.onClick(...r))},Y,14,Q)}var b=P(K,[["render",ee]]);const te=Object.assign(b,{install:(e,s)=>{var o;const n=(o=s==null?void 0:s.iconPrefix)!=null?o:"";e.component(n+b.name,b)}}),se={key:0,class:"mt-50px w-full text-center justify-content-center"},ne={class:""},oe={style:{color:"red"}},ie={class:"flex"},ae={class:"flex-1 pt-12 text-left pl-20"},re={key:0},le={class:"mt-8"},ue=N({__name:"add-sign",setup(e){const s=F(),o=D(),n=E();p();async function p(){if(console.log(s.cookiesString,"cookieString.value"),!s.cookiesString){h.error("cookie不存在或已失效！");return}const t=await y({cookiesString:s.cookiesString},{url:"/api/getRoleList"});if(!Object.keys(t.data).length){localStorage.setItem("isCookie",""),s.setCookieString(""),o.replace({path:"/login"});return}n.value=t.data,console.log(n.value,"rsppp")}let a={};r();async function r(){const t=await y({},{url:"/api/getAddress"});console.log(t),t!=null&&t.result&&(a={address:t.result.address,longitude:t.result.location.lng,latitude:t.result.location.lat})}function L(t){if(!(a!=null&&a.address)){h.error("获取地址失败！请联系管理员！");return}return{ruleId:n.value.roleid,longitude:String(a.longitude),latitude:String(a.latitude),address:a.address,signPosintionId:t.signPosintionId,cookiesString:s.cookiesString,againsignin:t.signTime?1:0}}async function j(){const t=n.value.startList.find(k=>+k.signType==1),_=L(t),d=await y(_,{url:"/api/addsignin"});console.log(d,"签到完毕！！！！"),h.success("签到完毕！！！！"),p()}async function B(){const t=n.value.startList.find(k=>+k.signType==2),_=L(t),d=await y(_,{url:"/api/addsignin"});console.log(d,"签退完毕！！！！"),h.success("签退完毕！！！！"),p()}function R(){Z.warning({title:"Warning Notification",content:"确定退出登录嘛？",width:250,hideCancel:!1,onOk:()=>{localStorage.removeItem("isCookie"),s.setCookieString(""),o.replace({path:"/login"})},onClose:()=>{}})}return(t,_)=>{var T,$;const d=C("a-button"),k=C("a-list-item"),q=C("a-list");return n.value?(g(),S("div",se,[i("div",ne,u((T=n.value)==null?void 0:T.newTime),1),i("div",null,[c("已工作 "),i("span",oe,u((($=n.value)==null?void 0:$.countTime)||0),1),c(" 小时")]),w(q,{size:"Medium",class:"mt-40px h-500px"},{header:f(()=>[c(" 我爱考勤 ")]),default:f(()=>[(g(!0),S(G,null,H(n.value.startList,(l,M)=>(g(),x(k,{key:M},{default:f(()=>[i("div",ie,[i("div",null,[c(u(+l.signType==1?"签到":"签退")+" ",1),i("div",null,u(+l.signType==1?"09:00":"19:30"),1)]),i("div",ae,[l.signAddress?(g(),S("div",re,[w(J(te)),c(" "+u(l.signAddress),1)])):I("",!0)]),i("div",le,[+l.signType==1?(g(),x(d,{key:0,onClick:j,status:l.signTime?"success":""},{default:f(()=>{var m,v;return[c(u(((v=(m=l.signTime)==null?void 0:m.split(" "))==null?void 0:v[1])||"签  到"),1)]}),_:2},1032,["status"])):(g(),x(d,{key:1,onClick:B,status:l.signTime?"success":""},{default:f(()=>{var m,v;return[c(u(((v=(m=l.signTime)==null?void 0:m.split(" "))==null?void 0:v[1])||"签  退"),1)]}),_:2},1032,["status"]))])])]),_:2},1024))),128))]),_:1}),w(d,{onClick:R,class:"fixed bottom-100",status:"danger"},{default:f(()=>[c("退 出 登 录")]),_:1})])):I("",!0)}}});export{ue as default};
